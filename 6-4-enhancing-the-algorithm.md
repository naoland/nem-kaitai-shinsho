前回は、各ノードが他のノードの信頼度をどのように数値化し、それを共有しているかについて解説しました。

しかし、実際のネットワークには自分の利益のためなら、他者の利益を損なっても良いと考える人もたくさんいます。

そこで、そのような悪意のある人物や集団が運用するノードの影響力を最小限にする工夫が必要になります。

今回は、この点についてNEMがどれくらい抵抗できるかについてのおはなしになります。

 ----

# 6.4 アルゴリズムの改良


これまでにお見せした信頼度評価システムは、他のノードが送ってくる情報の真実性（本当か嘘か）に関する情報が未知数であるところに弱点があります。

悪意あるノードは、単にネットワークを混乱させる目的で、信頼できるノードを低く評価し、信頼できないノードに高い評価を与えることが可能です。

なので信頼度として交換される数値の真実性を見極めないとなりません。

`ブロックチェーンに書き込まれる情報については検証できるけど、ノードの信頼度情報は検証できないということです。ビットコインのように完全に無視するというのも１つの手ではす。その代り、第一世代コインは不正ノードの脅威から逃れることはできません。`

そのために、通信先を共有している２つのノード（uとv）をペアにして、common(u, v)というノードのリストを作成します。

最初に、uとvが持つ信頼度リストを比較して、どのくらい一致しているかを数値化します。

![](https://s3-ap-northeast-1.amazonaws.com/nem-social/blog/10000/12000/12300/12323/1548721804%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-01-28%2012.32.40.png)

ここで、bは正の整数（文献ではb=1が推奨されています）。

`この中で、suwとsvwは共有しているノードについてノードuとノードvが持っている信頼値です。その差を取ってすべて足し合わせ、common(u,v)の大きさで割る感じです。自乗してからルートを取っているのはプラス・マイナスが打ち消し合わないためで、最後にb乗して調整できるようになっています。uとｖが持っている信頼値が似ているほど１に近くなります。共有ノードがなければ０です。`

次に、情報交換の真実性は：  
![](https://s3-ap-northeast-1.amazonaws.com/nem-social/blog/10000/12000/12300/12323/1548722273%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-01-28%2012.32.50.png)

で表せます。

`ノードiから見たノードjの「真実っぽさ」fijは、ノードiが通信したことのあるノード全部（ｍ）に対するsim(i, m)の合計を計算して、sim(i, j)を割ることで定義します。つまり、i, jによってすべてのノードが共有されて、その数値がまったく同じならば１に。大きく異なるほどその数値は低くなるはずです。ノードiとノードjが同じ信頼値を共有すればするほど数値は高く、共有するノードが少ないか、共有していてもその信頼値が食い違っているほど低くなります。`

このfijをまとめた行列をLとします。  

![](https://s3-ap-northeast-1.amazonaws.com/nem-social/blog/10000/12000/12300/12323/1548723464%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-01-28%2012.32.57.png)

Lの要素lijは上のfijにもともとの信頼値cijをかけて算出していますから、lijはそのどちらもが大きい、すなわちノードjに対する信頼度と真実度が共に大きい場合に、１に近い値なるはずです。

そして、6.3で出てきた式９の行列CをLで置き換えて、

![](https://s3-ap-northeast-1.amazonaws.com/nem-social/blog/10000/12000/12300/12323/1548723680%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-01-28%2012.33.06.png)

とすれば、信頼度ベクトルtは6.3と同様にあるひとつの値に収束していくことになります。


改良前のEigentrust++（信頼値計算）の論文では、高い信頼値を持つノードと不正ノードの間の通信を制限する方策をさらに追加する事が推奨されています。

しかし、論文は動画ファイルなどの共有を背景にして書かれたもので、ファイルの一部が正常なものか不正なものかを検証できません。

その場合は、たとえ信頼できるノードであっても、不正なファイルを破棄せず、他のノードに送ってしまいます。

一方、NEMネットワークは常にブロックチェーンと照合することによって、送られてきたデータが正常なものか不正なものかを検証できます。

よって、NEMネットワークのシミュレーションでは、正常 vs 不正ノードの通信を積極的に阻害しなくても、不正ノードの影響を十分に抑えることが可能です。

![](https://s3-ap-northeast-1.amazonaws.com/nem-social/blog/10000/12000/12300/12323/1548724212%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-01-28%2012.33.25.png)  
図6：攻撃ノードの割合によってネットワーク通信内にどの程度不正通信が蔓延するかのシミュレーション

----

```
コメント：

それぞれのNISノードは、常に他のノードとの通信の成否情報を蓄積して、信頼度のリストを作っています。さらに今回、通信先のノードが持つ信頼度リストを取り寄せ、自分が持っているリストとどのくらいそっくりかを計算することによって、もし自分と大きく異なる信頼度を持ったノードと通信した場合に、その評価を下げる仕組みがあることが分かりました。

ブロックチェーンの性質によって、不正な通信内容が確実に除外できるため、シミュレーションの結果は、ネットワークの９割が不正なノードになったとしても、９割以上の通信を正常なままに保つことができるとなっています。

このような仕組みはNEM独特のものなので、51%アタックどころか90％アタックすら、事実上起こりえないと考えて良いわけです。

ビットコインの相場に引きずられて、NEMの相場も乱高下するのを見ていると、このような技術的な特異性に市場はまったく無関心であることが感じられ、ちょっとさみしいです。PoWが完全に悪意に乗っ取られて他のコインが信頼性を失うような状況が起きたとしても、NEMネットワークは生き残るんじゃないかと思うので、とりあえずガチホします。
```

いつも読んでくださってありがとうございます！
